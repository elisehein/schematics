@keyframes erratic-rotate-scale {
  0%  { transform: translateZ(var(--half-cube-size)) rotate3d(1, 1, 1, 0deg); }
  5%  { transform: translateZ(var(--half-cube-size)) rotate3d(1, 1, 1, 360deg); }
  10% { transform: translateZ(var(--half-cube-size)) rotate3d(1, 1, 1, 0deg); }
  15% { transform: translateZ(var(--half-cube-size)) rotate3d(1, 1, 1, 360deg) scale(1); }
  20% { transform: translateZ(var(--half-cube-size)) rotate3d(1, 1, 1, 0deg); }
  25% { transform: translateZ(var(--half-cube-size)) rotate3d(1, 1, 1, 360deg) scale3d(.5, .5, .5); }
  30% { transform: translateZ(var(--half-cube-size)) rotate3d(1, .2, .5, 0deg); }
  35% { transform: translateZ(var(--half-cube-size)) rotate3d(1, .2, .5, 360deg); }
  40% { transform: translateZ(var(--half-cube-size)) rotate3d(1, .2, .5, 0); }
  45% { transform: translateZ(var(--half-cube-size)) rotate3d(1, .2, .5, 360deg) scale3d(1.5, 1.5, 1.5); }
  50% { transform: translateZ(var(--half-cube-size)) rotate3d(1, .2, .5, 0deg); }
  55% { transform: translateZ(var(--half-cube-size)) rotate3d(1, .2, .5, 360deg); }
  60% { transform: translateZ(var(--half-cube-size)) rotate3d(1, .2, .5, 0); }
  65% { transform: translateZ(var(--half-cube-size)) rotate3d(1, .2, .5, 360deg) scale3d(.4, .4, .4); }
  70% { transform: translateZ(var(--half-cube-size)) rotate3d(1, 1, 1, 0deg); }
  75% { transform: translateZ(var(--half-cube-size)) rotate3d(1, 1, 1, 360deg) scale(1, 1, 1); }
  80% { transform: translateZ(var(--half-cube-size)) rotate3d(1, 1, 1, 0deg); }
  85% { transform: translateZ(var(--half-cube-size)) rotate3d(1, 1, 1, 360deg); }
  90% { transform: translateZ(var(--half-cube-size)) rotate3d(1, 1, 1, 0deg); }
  95% { transform: translateZ(var(--half-cube-size)) rotate3d(1, 1, 1, 360deg) scale(1); }
  100% { transform: translateZ(var(--half-cube-size)) rotate3d(1, 1, 1, 0deg) scale(.1, .1, .1); }
}

figure-43-diagram {
  /* Percentage units in translateZ aren't supported, so we need to modify the cube size manually */
  --cube-size: 40vw;
  --half-cube-size: calc(var(--cube-size) / 2);

  @media (min-width: 40em) {
    --cube-size: 30vw;
  }

  @media (--layout-aside-always-visible) {
    --cube-size: 15rem;
  }

  .cube {
    position: relative;
    width: var(--cube-size);
    height: var(--cube-size);
    transform-style: preserve-3d;
    animation: erratic-rotate-scale 70s linear;
    animation-iteration-count: infinite;
    animation-direction: alternate;

    &__face {
      position: absolute;
      top: 0;
      left: 0;
      width: var(--cube-size);
      height: var(--cube-size);
      border: .0625rem solid var(--color-text);

      &--front {
        transform: rotateY(0deg) translateZ(var(--half-cube-size));
      }

      &--back {
        transform: rotateY(180deg) translateZ(var(--half-cube-size));
      }

      &--right {
        transform: rotateY(90deg) translateZ(var(--half-cube-size));
      }

      &--left {
        transform: rotateY(-90deg) translateZ(var(--half-cube-size));
      }

      &--top {
        transform: rotateX(90deg) translateZ(var(--half-cube-size));
      }

      &--bottom {
        transform: rotateX(-90deg) translateZ(var(--half-cube-size));
      }
    }
  }
}
